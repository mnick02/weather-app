<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="search-container">
        <input type="text" id="search-input" placeholder="Enter City...">
        <button id="search-btn">Search</button>
        <div id="data"></div>

        <img src="#">
    </div>
    <script>
        /*fetch("https://weather.visualcrossing.com/VisualCrossingWebServices/rest/services/timeline/seattle?key=WN35YQJQT7PBM9BPP2TQMFB24", {mode: "cors"})
            .then(function(response) {
                return response.json();
            })
            .then(function(response) {
                console.log(response.currentConditions);
            });*/
        const searchInput = document.getElementById("search-input");
        const searchBtn = document.getElementById("search-btn");
        const data = document.getElementById("data");
        const body = document.body;
        const img = document.querySelector("img");

        const API_KEY = "WN35YQJQT7PBM9BPP2TQMFB24";

        let searchTerm = "seattle";

        function setBgColor(feelsLike) {
            if (feelsLike >= 90) {
                body.style.backgroundColor = "#ff5722";
                //add icons?
            }
            else if (feelsLike >= 75) {
                body.style.backgroundColor = "#ffcc80";
            }
            else if (feelsLike >= 65) {
                body.style.backgroundColor ="#a5d6a7";
            }
            else if (feelsLike >= 50) {
                body.style.backgroundColor = "#81d4fa";
            }
            else if (feelsLike >= 32) {
                body.style.backgroundColor = "#b3e5fc";
            }
            else {
                body.style.backgroundColor = "#e1f5fe";
            }
        }

        function setImage(condition) {
            const firstCondition = condition.split(",")[0].trim();

            if (firstCondition == "Rain") {
                img.src = "./cloud-drizzle.svg";
            }
            else if (firstCondition == "Clear") {
                img.src = "./sun.svg";
            }
            else if (firstCondition == "Partially cloudy") {
                img.src = "./partial.png";
            }
            else if (firstCondition == "Snow") {
                img.src = "./cloud-snow.svg"
            }
            else if (firstCondition == "Overcast") {
                img.src = "./partial.png";
            }
        }


        function fetchWeather(searchQuery) {
            fetch(`https://weather.visualcrossing.com/VisualCrossingWebServices/rest/services/timeline/${searchQuery}?key=${API_KEY}`, {mode: "cors"})
                .then(function(response) {
                    return response.json();
                })
                .then(function(response) {
                    console.log(response);
                    setBgColor(response.currentConditions.feelslike);
                    setImage(response.currentConditions.conditions);

                    const details = [
                        { label: "Location: ", value: `${response.address}` },
                        { label: "Feels Like: ", value: `${response.currentConditions.feelslike}Â°F` },
                        { label: "Conditions: ", value: `${response.currentConditions.conditions}` },
                        { label: "Time: ", value: `${response.currentConditions.datetime}` },
                        { label: "Humidity: ", value: `${response.currentConditions.humidity}` }
                    ];



                    //data.textContent = response.currentConditions.feelslike;
                    //Change up add more to display all good data

                    details.forEach(detail => {
                        const detailItem = document.createElement("div");

                        const detailLabel = document.createElement("span");
                        detailLabel.textContent = detail.label;

                        const detailValue = document.createElement("span");
                        detailValue.textContent = detail.value;

                        detailItem.appendChild(detailLabel);
                        detailItem.appendChild(detailValue);
                        data.appendChild(detailItem);
                    })
                });
        }

        fetchWeather(searchTerm);

        searchBtn.addEventListener("click", function() {
            body.style.backgroundColor = "";
            img.src = "";
            data.textContent = "";
            searchTerm = searchInput.value.trim() || "seattle";
            fetchWeather(searchTerm);
        });

        
    </script>
</body>
</html>